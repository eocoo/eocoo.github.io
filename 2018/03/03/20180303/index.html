<!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="utf-8">
  
  <title>postgre 常用命令 | Essay</title>
  <meta name="author" content="shanhm1991">
  
  <meta name="description" content="引言">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="postgre 常用命令"/>
  <meta property="og:site_name" content="Essay"/>

  
    <meta property="og:image" content=""/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Essay" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-147251181-1', 'auto');
	ga('send', 'pageview');

</script>


<meta name="generator" content="Hexo 4.2.0"></head>


<body>
  <header id="header" class="inner"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="alignleft">
  <h1><a href="/">Essay</a></h1>
  <h2><font style="color: #999;">articles:  85 &nbsp;&nbsp;&nbsp; views: <span id="busuanzi_value_site_uv"></span></font></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/about">Abount</a></li>
    
      <li><a href="/books">Books</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>

<div class="clearfix"></div>
</header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article id="post-20180303" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2018-03-02T16:00:00.000Z"><a href="/2018/03/03/20180303/">2018-03-03</a></time>
      
      

  
  
    <h1 class="p-name title" itemprop="headline name">
        postgre 常用命令
    </h1>
    
    
  
  
  


<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


   <font style="color: #999;"> words: 1.9k  &nbsp;&nbsp; views: <span id="busuanzi_value_page_pv"></span> &nbsp;&nbsp; time: 11min</font>
   
   
  
  <div class="categories">
    <a href="/categories/数据库/">数据库</a>
  </div>


   
   
  
  <div class="tags">
    <a href="/tags/postgre/">postgre</a>
  </div>


   
   <hr style="background-color: #ddd; height:1px; border:none;" /><br>
   


    </header>
      
    <div class="e-content entry" itemprop="articleBody">
      
        <h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><a id="more"></a>

<h3 id="1-psql"><a href="#1-psql" class="headerlink" title="1. psql"></a>1. psql</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">psql is the PostgreSQL interactive terminal.</span><br><span class="line"></span><br><span class="line">Usage:</span><br><span class="line">  psql [OPTION]... [DBNAME [USERNAME]]</span><br><span class="line"></span><br><span class="line">General options:</span><br><span class="line">  -c, --command&#x3D;COMMAND    run only single command (SQL or internal) and exit</span><br><span class="line">  -d, --dbname&#x3D;DBNAME      database name to connect to (default: &quot;root&quot;)</span><br><span class="line">  -f, --file&#x3D;FILENAME      execute commands from file, then exit</span><br><span class="line">  -l, --list               list available databases, then exit</span><br><span class="line">  -v, --set&#x3D;, --variable&#x3D;NAME&#x3D;VALUE</span><br><span class="line">                           set psql variable NAME to VALUE</span><br><span class="line">                           (e.g., -v ON_ERROR_STOP&#x3D;1)</span><br><span class="line">  -V, --version            output version information, then exit</span><br><span class="line">  -X, --no-psqlrc          do not read startup file (~&#x2F;.psqlrc)</span><br><span class="line">  -1 (&quot;one&quot;), --single-transaction</span><br><span class="line">                           execute as a single transaction (if non-interactive)</span><br><span class="line">  -?, --help[&#x3D;options]     show this help, then exit</span><br><span class="line">      --help&#x3D;commands      list backslash commands, then exit</span><br><span class="line">      --help&#x3D;variables     list special variables, then exit</span><br><span class="line"></span><br><span class="line">Input and output options:</span><br><span class="line">  -a, --echo-all           echo all input from script</span><br><span class="line">  -b, --echo-errors        echo failed commands</span><br><span class="line">  -e, --echo-queries       echo commands sent to server</span><br><span class="line">  -E, --echo-hidden        display queries that internal commands generate</span><br><span class="line">  -L, --log-file&#x3D;FILENAME  send session log to file</span><br><span class="line">  -n, --no-readline        disable enhanced command line editing (readline)</span><br><span class="line">  -o, --output&#x3D;FILENAME    send query results to file (or |pipe)</span><br><span class="line">  -q, --quiet              run quietly (no messages, only query output)</span><br><span class="line">  -s, --single-step        single-step mode (confirm each query)</span><br><span class="line">  -S, --single-line        single-line mode (end of line terminates SQL command)</span><br><span class="line"></span><br><span class="line">Output format options:</span><br><span class="line">  -A, --no-align           unaligned table output mode</span><br><span class="line">      --csv                CSV (Comma-Separated Values) table output mode</span><br><span class="line">  -F, --field-separator&#x3D;STRING</span><br><span class="line">                           field separator for unaligned output (default: &quot;|&quot;)</span><br><span class="line">  -H, --html               HTML table output mode</span><br><span class="line">  -P, --pset&#x3D;VAR[&#x3D;ARG]     set printing option VAR to ARG (see \pset command)</span><br><span class="line">  -R, --record-separator&#x3D;STRING</span><br><span class="line">                           record separator for unaligned output (default: newline)</span><br><span class="line">  -t, --tuples-only        print rows only</span><br><span class="line">  -T, --table-attr&#x3D;TEXT    set HTML table tag attributes (e.g., width, border)</span><br><span class="line">  -x, --expanded           turn on expanded table output</span><br><span class="line">  -z, --field-separator-zero</span><br><span class="line">                           set field separator for unaligned output to zero byte</span><br><span class="line">  -0, --record-separator-zero</span><br><span class="line">                           set record separator for unaligned output to zero byte</span><br><span class="line"></span><br><span class="line">Connection options:</span><br><span class="line">  -h, --host&#x3D;HOSTNAME      database server host or socket directory (default: &quot;&#x2F;var&#x2F;run&#x2F;postgresql&quot;)</span><br><span class="line">  -p, --port&#x3D;PORT          database server port (default: &quot;5433&quot;)</span><br><span class="line">  -U, --username&#x3D;USERNAME  database user name (default: &quot;root&quot;)</span><br><span class="line">  -w, --no-password        never prompt for password</span><br><span class="line">  -W, --password           force password prompt (should happen automatically)</span><br></pre></td></tr></table></figure>

<p><strong>psql登录示例：</strong></p>
<p><code>psql -h 192.168.141.13 -p 5432 -d postgres -U postgres -W</code>  </p>
<p><code>psql &quot;host=192.168.141.13 port=5432 user=postgres password=postgres dbname=postgres&quot;</code></p>
<p><code>psql &quot;host=192.168.141.13 port=5432 user=postgres password=postgres dbname=postgres&quot; -c &quot;select * from test;&quot;</code></p>
<p><code>psql &quot;host=192.168.141.13 port=5432 user=postgres password=postgres dbname=postgres&quot; -f test.sql</code></p>
<p><strong>psql常用操作：</strong>
    <table>
        <tr>
            <td><code>\l</code></td>
            <td>：查看所有数据库</td>
        </tr>
        <tr>
            <td><code>\dt</code></td>
            <td>：查看表</td>
        </tr>
        <tr>
            <td><code>\password username</code></td>
            <td>：修改密码</td>
        </tr>
        <tr>
            <td><code>\password</code></td>
            <td>：设置密码</td>
        </tr>
        <tr>
            <td><code>\?</code></td>
            <td>：查看psql命令列表</td>
        </tr>
        <tr>
            <td><code>\c [database_name]</code></td>
            <td>：连接其他数据库，切换数据库</td>
        </tr>
        <tr>
            <td><code>\conninfo</code></td>
            <td>：列出当前数据库和连接的信息</td>
        </tr>
        <tr>
            <td><code>\d</code></td>
            <td>：列出当前数据库的所有表</td>
        </tr>
        <tr>
            <td><code>\d [table_name]</code></td>
            <td>：列出某一张表格的结构</td>
        </tr>
        <tr>
            <td><code>\du</code></td>
            <td>：列出所有用户</td>
        </tr>
        <tr>
            <td><code>\e</code></td>
            <td>：打开文本编辑器</td>
        </tr>
        <tr>
            <td><code>help</code></td>
            <td>：帮助</td>
        </tr>
        <tr>
            <td><code>\h</code></td>
            <td>：查看SQL命令的解释，比如\h select</td>
        </tr>
        <tr>
            <td><code>\q</code></td>
            <td>：退出</td>
        </tr>
    </table></p>
<p><strong>常用sql：</strong>
    <table>
        <tr>
            <td>查看版本</td>
            <td><code>select version();</code></td>
        </tr>
        <tr>
            <td>查看当前数据库</td>
            <td><code>select current_database();</code></td>
        </tr>
        <tr>
            <td>查看用户</td>
            <td><code>select * from pg_roles;</code></td>
        </tr>
        <tr>
            <td>查看权限</td>
            <td><code>select * from information_schema.table_privileges where grantee=&#39;cc&#39;;</code></td>
        </tr>
        <tr>
            <td>查看用户名密码</td>
            <td><code>select rolname,rolpassword from pg_authid;</code>  <code>select usename,passwd from pg_shadow;</code></td>
        </tr>
        <tr>
            <td>创建用户并设置密码</td>
            <td><code>CREATE USER shanhm WITH PASSWORD &#39;shanhm&#39;;</code></td>
        </tr>
        <tr>
            <td>创建数据库并指定用户</td>
            <td><code>CREATE DATABASE shanhm OWNER shanhm;</code></td>
        </tr>
        <tr>
            <td>数据库赋权</td>
            <td><code>GRANT ALL PRIVILEGES ON DATABASE shanhm TO shanhm;</code></td>
        </tr>
    </table></p>
<h3 id="2-pg-dump"><a href="#2-pg-dump" class="headerlink" title="2. pg_dump"></a>2. pg_dump</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">pg_dump dumps a database as a text file or to other formats.</span><br><span class="line"></span><br><span class="line">Usage:</span><br><span class="line">  pg_dump [OPTION]... [DBNAME]</span><br><span class="line"></span><br><span class="line">General options:</span><br><span class="line">  -f, --file&#x3D;FILENAME          output file or directory name</span><br><span class="line">  -F, --format&#x3D;c|d|t|p         output file format (custom, directory, tar,</span><br><span class="line">                               plain text (default))</span><br><span class="line">  -j, --jobs&#x3D;NUM               use this many parallel jobs to dump</span><br><span class="line">  -v, --verbose                verbose mode</span><br><span class="line">  -V, --version                output version information, then exit</span><br><span class="line">  -Z, --compress&#x3D;0-9           compression level for compressed formats</span><br><span class="line">  --lock-wait-timeout&#x3D;TIMEOUT  fail after waiting TIMEOUT for a table lock</span><br><span class="line">  --no-sync                    do not wait for changes to be written safely to disk</span><br><span class="line">  -?, --help                   show this help, then exit</span><br><span class="line"></span><br><span class="line">Options controlling the output content:</span><br><span class="line">  -a, --data-only              dump only the data, not the schema</span><br><span class="line">  -b, --blobs                  include large objects in dump</span><br><span class="line">  -B, --no-blobs               exclude large objects in dump</span><br><span class="line">  -c, --clean                  clean (drop) database objects before recreating</span><br><span class="line">  -C, --create                 include commands to create database in dump</span><br><span class="line">  -E, --encoding&#x3D;ENCODING      dump the data in encoding ENCODING</span><br><span class="line">  -n, --schema&#x3D;PATTERN         dump the specified schema(s) only</span><br><span class="line">  -N, --exclude-schema&#x3D;PATTERN do NOT dump the specified schema(s)</span><br><span class="line">  -O, --no-owner               skip restoration of object ownership in</span><br><span class="line">                               plain-text format</span><br><span class="line">  -s, --schema-only            dump only the schema, no data</span><br><span class="line">  -S, --superuser&#x3D;NAME         superuser user name to use in plain-text format</span><br><span class="line">  -t, --table&#x3D;PATTERN          dump the specified table(s) only</span><br><span class="line">  -T, --exclude-table&#x3D;PATTERN  do NOT dump the specified table(s)</span><br><span class="line">  -x, --no-privileges          do not dump privileges (grant&#x2F;revoke)</span><br><span class="line">  --binary-upgrade             for use by upgrade utilities only</span><br><span class="line">  --column-inserts             dump data as INSERT commands with column names</span><br><span class="line">  --disable-dollar-quoting     disable dollar quoting, use SQL standard quoting</span><br><span class="line">  --disable-triggers           disable triggers during data-only restore</span><br><span class="line">  --enable-row-security        enable row security (dump only content user has</span><br><span class="line">                               access to)</span><br><span class="line">  --exclude-table-data&#x3D;PATTERN do NOT dump data for the specified table(s)</span><br><span class="line">  --extra-float-digits&#x3D;NUM     override default setting for extra_float_digits</span><br><span class="line">  --if-exists                  use IF EXISTS when dropping objects</span><br><span class="line">  --include-foreign-data&#x3D;PATTERN</span><br><span class="line">                               include data of foreign tables on foreign</span><br><span class="line">                               servers matching PATTERN</span><br><span class="line">  --inserts                    dump data as INSERT commands, rather than COPY</span><br><span class="line">  --load-via-partition-root    load partitions via the root table</span><br><span class="line">  --no-comments                do not dump comments</span><br><span class="line">  --no-publications            do not dump publications</span><br><span class="line">  --no-security-labels         do not dump security label assignments</span><br><span class="line">  --no-subscriptions           do not dump subscriptions</span><br><span class="line">  --no-synchronized-snapshots  do not use synchronized snapshots in parallel jobs</span><br><span class="line">  --no-tablespaces             do not dump tablespace assignments</span><br><span class="line">  --no-unlogged-table-data     do not dump unlogged table data</span><br><span class="line">  --on-conflict-do-nothing     add ON CONFLICT DO NOTHING to INSERT commands</span><br><span class="line">  --quote-all-identifiers      quote all identifiers, even if not key words</span><br><span class="line">  --rows-per-insert&#x3D;NROWS      number of rows per INSERT; implies --inserts</span><br><span class="line">  --section&#x3D;SECTION            dump named section (pre-data, data, or post-data)</span><br><span class="line">  --serializable-deferrable    wait until the dump can run without anomalies</span><br><span class="line">  --snapshot&#x3D;SNAPSHOT          use given snapshot for the dump</span><br><span class="line">  --strict-names               require table and&#x2F;or schema include patterns to</span><br><span class="line">                               match at least one entity each</span><br><span class="line">  --use-set-session-authorization</span><br><span class="line">                               use SET SESSION AUTHORIZATION commands instead of</span><br><span class="line">                               ALTER OWNER commands to set ownership</span><br><span class="line"></span><br><span class="line">Connection options:</span><br><span class="line">  -d, --dbname&#x3D;DBNAME      database to dump</span><br><span class="line">  -h, --host&#x3D;HOSTNAME      database server host or socket directory</span><br><span class="line">  -p, --port&#x3D;PORT          database server port number</span><br><span class="line">  -U, --username&#x3D;NAME      connect as specified database user</span><br><span class="line">  -w, --no-password        never prompt for password</span><br><span class="line">  -W, --password           force password prompt (should happen automatically)</span><br><span class="line">  --role&#x3D;ROLENAME          do SET ROLE before dump</span><br><span class="line"></span><br><span class="line">If no database name is supplied, then the PGDATABASE environment</span><br><span class="line">variable value is used.</span><br></pre></td></tr></table></figure>

<p><strong>备份：</strong></p>
<p><code>pg_dump -h 192.168.141.13 -p 5432 -U postgres $dbname &gt; db.sql</code> (如上面帮助文档，-s：仅结构；-a：仅数据)</p>
<p><code>pg_dump -h 192.168.141.13 -p 5432 -U postgres -d $dbname -t $tbname&gt; tb.sql</code></p>
<p><code>pg_dump &quot;host=192.168.141.13 port=5432 user=postgres password=postgres dbname=test&quot; -f db.sql</code></p>
<p><code>pg_dump &quot;host=192.168.141.13 port=5432 user=postgres password=postgres dbname=test&quot; -t $tbname -f tb.sql</code></p>
<p><code>pg_dump &quot;host=192.168.141.13 port=5432 user=postgres password=postgres dbname=test&quot; -F c -f db.dump</code></p>
<h3 id="3-pg-restore"><a href="#3-pg-restore" class="headerlink" title="3. pg_restore"></a>3. pg_restore</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">pg_restore restores a PostgreSQL database from an archive created by pg_dump.</span><br><span class="line"></span><br><span class="line">Usage:</span><br><span class="line">  pg_restore [OPTION]... [FILE]</span><br><span class="line"></span><br><span class="line">General options:</span><br><span class="line">  -d, --dbname&#x3D;NAME        connect to database name</span><br><span class="line">  -f, --file&#x3D;FILENAME      output file name (- for stdout)</span><br><span class="line">  -F, --format&#x3D;c|d|t       backup file format (should be automatic)</span><br><span class="line">  -l, --list               print summarized TOC of the archive</span><br><span class="line">  -v, --verbose            verbose mode</span><br><span class="line">  -V, --version            output version information, then exit</span><br><span class="line">  -?, --help               show this help, then exit</span><br><span class="line"></span><br><span class="line">Options controlling the restore:</span><br><span class="line">  -a, --data-only              restore only the data, no schema</span><br><span class="line">  -c, --clean                  clean (drop) database objects before recreating</span><br><span class="line">  -C, --create                 create the target database</span><br><span class="line">  -e, --exit-on-error          exit on error, default is to continue</span><br><span class="line">  -I, --index&#x3D;NAME             restore named index</span><br><span class="line">  -j, --jobs&#x3D;NUM               use this many parallel jobs to restore</span><br><span class="line">  -L, --use-list&#x3D;FILENAME      use table of contents from this file for</span><br><span class="line">                               selecting&#x2F;ordering output</span><br><span class="line">  -n, --schema&#x3D;NAME            restore only objects in this schema</span><br><span class="line">  -N, --exclude-schema&#x3D;NAME    do not restore objects in this schema</span><br><span class="line">  -O, --no-owner               skip restoration of object ownership</span><br><span class="line">  -P, --function&#x3D;NAME(args)    restore named function</span><br><span class="line">  -s, --schema-only            restore only the schema, no data</span><br><span class="line">  -S, --superuser&#x3D;NAME         superuser user name to use for disabling triggers</span><br><span class="line">  -t, --table&#x3D;NAME             restore named relation (table, view, etc.)</span><br><span class="line">  -T, --trigger&#x3D;NAME           restore named trigger</span><br><span class="line">  -x, --no-privileges          skip restoration of access privileges (grant&#x2F;revoke)</span><br><span class="line">  -1, --single-transaction     restore as a single transaction</span><br><span class="line">  --disable-triggers           disable triggers during data-only restore</span><br><span class="line">  --enable-row-security        enable row security</span><br><span class="line">  --if-exists                  use IF EXISTS when dropping objects</span><br><span class="line">  --no-comments                do not restore comments</span><br><span class="line">  --no-data-for-failed-tables  do not restore data of tables that could not be</span><br><span class="line">                               created</span><br><span class="line">  --no-publications            do not restore publications</span><br><span class="line">  --no-security-labels         do not restore security labels</span><br><span class="line">  --no-subscriptions           do not restore subscriptions</span><br><span class="line">  --no-tablespaces             do not restore tablespace assignments</span><br><span class="line">  --section&#x3D;SECTION            restore named section (pre-data, data, or post-data)</span><br><span class="line">  --strict-names               require table and&#x2F;or schema include patterns to</span><br><span class="line">                               match at least one entity each</span><br><span class="line">  --use-set-session-authorization</span><br><span class="line">                               use SET SESSION AUTHORIZATION commands instead of</span><br><span class="line">                               ALTER OWNER commands to set ownership</span><br><span class="line"></span><br><span class="line">Connection options:</span><br><span class="line">  -h, --host&#x3D;HOSTNAME      database server host or socket directory</span><br><span class="line">  -p, --port&#x3D;PORT          database server port number</span><br><span class="line">  -U, --username&#x3D;NAME      connect as specified database user</span><br><span class="line">  -w, --no-password        never prompt for password</span><br><span class="line">  -W, --password           force password prompt (should happen automatically)</span><br><span class="line">  --role&#x3D;ROLENAME          do SET ROLE before restore</span><br><span class="line"></span><br><span class="line">The options -I, -n, -N, -P, -t, -T, and --section can be combined and specified</span><br><span class="line">multiple times to select multiple objects.</span><br><span class="line"></span><br><span class="line">If no input file name is supplied, then standard input is used.</span><br></pre></td></tr></table></figure>

<p><strong>恢复数据库</strong></p>
<p><code>pg_restore -h 192.168.141.13 -U postgres -d $dbname db.dump</code></p>

      
    </div>
	
    <footer>
      
	  
	    
	<nav id="pagination">
	  
		  <a class="alignleft prev" href="/2018/03/10/20180310/">
		    Linux I/O模型
		  </a>
	  
	  
	  
		  <a class="alignright next" href="/2018/03/01/20180301/">
		    常用命令
		  </a>
	  
	  <div class="clearfix"></div>
	</nav>
	
	    
        
  
  <div class="categories">
    <a href="/categories/数据库/">数据库</a>
  </div>


        
  
  <div class="tags">
    <a href="/tags/postgre/">postgre</a>
  </div>


        
  <div class="addthis addthis_toolbox addthis_default_style">
    
    
      <a class="addthis_button_tweet"></a>
    
    
      <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    
    
    <a class="addthis_counter addthis_pill_style"></a>
  </div>
  <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js"></script>

        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk@latest/dist/gitalk.min.js"></script>
<script src="/js/md5.min.js"></script>
<div id="gitalk-container"></div>
<script type="text/javascript">
    var gitalk = new Gitalk({
        clientID: 'd7beb7890a79c73a3e3d',
        clientSecret: '80ea1fc195ae4b80cbd65ec9f1ce68d59595af4b',
        id: md5(window.location.pathname),
        repo: 'shanhm1991.github.io',
        owner: 'shanhm1991',
        admin: 'shanhm1991'
    })
    gitalk.render('gitalk-container')
</script>                              



</div></div>
    <aside id="sidebar" class="alignright">
  


  

  

  

  
<div class="widget catlog">
<h3 class="title">Catlog</h3>
<ul class="entry_catlog">
<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#引言"><span class="toc-text">引言</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-psql"><span class="toc-text">1. psql</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-pg-dump"><span class="toc-text">2. pg_dump</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-pg-restore"><span class="toc-text">3. pg_restore</span></a></li></ol></li></ol>
</div>




</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">

  
  
      &copy; 2021 shanhm1991 
  
  
  
  <font style="float: right">
</div>
<div class="clearfix"></div>
</footer>
  
<script src="/js/jquery-3.4.1.min.js"></script>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>
